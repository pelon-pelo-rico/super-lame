<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Step 8</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <style>body{margin:0}</style>
</head>
<body>
  <a-scene>
    <!-- Preload three 360 images -->
    <a-assets>
      <img id="p1" src="afrikaans_church_interior.jpg">
      <img id="p2" src="industrial_wooden_attic.jpg">
      <img id="p3" src="rogland_clear_night.jpg">
    </a-assets>

    <!-- Camera: look around with mouse -->
    <a-entity camera look-controls position="0 1.6 0"></a-entity>

    <!-- Mouse cursor to click the sphere -->
    <a-entity cursor="rayOrigin: mouse" raycaster="objects: .interactable"></a-entity>

    <!-- 360 background -->
    <a-sky id="sky" src="#p1"></a-sky>

    <!-- Sphere that changes the 360 background and moves each click -->
    <a-sphere id="cycler" class="interactable" radius="0.25" color="#FF7F50"></a-sphere>
  </a-scene>

  <script>
    // Minimal cycler: click the sphere -> change sky image and move sphere
    AFRAME.registerComponent('cycle-panos', {
      init: function () {
        this.idx = 0;
        this.panos = ['#p1', '#p2', '#p3'];
        this.positions = [
          new THREE.Vector3(0, 1.25, -2),
          new THREE.Vector3(-1.2, 1.3, -2.2),
          new THREE.Vector3(1.4, 1.2, -1.8)
        ];
        // place sphere for the initial 360 image
        this.el.object3D.position.copy(this.positions[this.idx]);

        this.el.addEventListener('click', () => {
          this.idx = (this.idx + 1) % this.panos.length;
          document.getElementById('sky').setAttribute('src', this.panos[this.idx]);
          this.el.object3D.position.copy(this.positions[this.idx]);
        });
      }
    });

    // Attach the component to the sphere
    document.getElementById('cycler').setAttribute('cycle-panos', '');
  </script>
</body>
</html>
